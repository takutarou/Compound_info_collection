# 1. はじめに
化合物情報収集プロジェクトへのご関心ありがとうございます！このプロジェクトは点眼薬成分の化学物質情報をPubChem APIから効率的に収集するためのツールです。貢献を歓迎します。以下のガイドラインに従って、提案・修正・改善をお願いします。

# 2. バグ報告
バグを報告する際は、以下の情報を明記してください：
- 発生した現象
- 再現手順
- 環境（OS、バージョンなど）
- エラーメッセージ（あれば）

# 3. 機能追加、提案
新機能の提案は issue にて事前にご相談ください。重複を避けるため、既存の issue をご確認ください。
新機能案に関するブラッシュアップは別のチャットサービスなどでも良いですが、最終的な提案は必ず残してください。

# 4. Pull Request
1. リポジトリをフォークしてください
2. 新しいブランチを作成してください（例: `feature/〇〇機能追加`）
3. 修正後、プルリクエストを作成してください
4. レビューが完了するまでお待ちください（コメントがつく場合があります）

# 5. commitメッセージ

## 5.1 type別
|タイプ|内容|
|-|-|
|feat|新機能の追加|
|fix|バグ修正|
|docs|ドキュメントのみの変更（READMEなど）|
|style|フォーマット修正（スペース、インデント、セミコロンなど）|
|refactor|リファクタリング（機能の変更なし）|
|test|テストコードの追加・修正|
|chore|ビルドやCI、依存ライブラリの更新など|
|perf|パフォーマンス改善|
|-|-|

## 5.2 scope別
### 5.2.1 機能・コンポーネント名ベース
|タイプ|内容|
|-|-|
|pubchem|PubChem API関連の処理|
|screening|点眼薬スクリーニング関連機能|
|data|データ処理・変換機能|
|client|API クライアント処理|
|processor|化合物データ処理|
|models|データモデル定義|
|-|-|

### 5.2.2 レイヤー・構造ベース
|タイプ|内容|
|-|-|
|api|API通信（リクエスト/レスポンス）|
|model|DBモデル・データ構造|
|controller|ビジネスロジック層（MVC型など）|
|view|HTMLテンプレート、UIなど|
|utils|共通関数やユーティリティ関数|
|-|-|

### 5.2.3 開発支援・環境構成ベース
|タイプ|内容|
|-|-|
|test|単体テスト、結合テストなど|
|ci|GitHub Actions や CircleCI など|
|build|ビルドツールや設定変更|
|deps|依存パッケージの更新|
|config|環境設定ファイル（.env, json等）|
|-|-|

### 5.2.4 技術スタックやライブラリ名
|タイプ|内容|
|-|-|
|pandas|Pandasデータ処理関連|
|requests|HTTP通信・API関連|
|tqdm|プログレスバー表示|
|openpyxl|Excelファイル処理|
|-|-|

## 5.3 subject
- 内容を簡潔に記載（日本語でもOK）
- 文末にピリオドは不要
- 命令形（「〜を追加」「〜を修正」）で統一
- 「修正しました」など主語・時制は不要

## 5.4 commitメッセージのテンプレート
<type>(<scope>): <subject>

## 5.5 commitの例を追加
feat(pubchem): SID対応による検索成功率向上機能を追加
fix(client): CAS番号検証エラーによるスクリプト停止を修正
refactor(utils): HTTP リトライ処理を共通化
chore(deps): pandas 2.3.0 にアップグレード
docs(readme): 仮想環境のセットアップ手順を追記
feat(screening): 点眼薬成分の安全性評価機能を追加
perf(processor): バッチ処理による API呼び出し効率化

# 6. commitの粒度ルール
1つの目的につき、1コミット
- ルール1：「ひとつの意味のある変更ごとにコミットする」<br>
→新機能追加、バグ修正、UI調整などはそれぞれ別のコミット
- ルール2：「無関係な変更を1つのコミットにまとめない」<br>
→ 例：バグ修正とドキュメント更新を同時にコミットしない

## 6.1 commitの粒度の参考例
|変更内容|コミットの分け方|コメント例|
|-|-|-|
|PubChem API の新機能 + テスト追加|分ける|feat(pubchem): SID検索機能を追加 <br> test(pubchem): SID検索のテストケースを追加|
|バグ修正 + ドキュメント更新|分ける|fix(client): CAS検証処理のエラーを修正 <br> docs(readme): エラー対処方法を追記|
|モジュール分割 + 設定ファイル移行|分ける|refactor(structure): 巨大スクリプトをモジュール分割 <br> chore(config): 設定値をsettings.pyに移行|
|-|-|-|

**迷った時は、このaddをcommitする場合はコメントがどのようになりそうか（1目的で記載できそうか）の視点で判断すると良い**

## 6.2 docsの粒度の参考例
### 6.2.1基本ルール
|状況|粒度の目安|コミット例|
|-|-|-|
|READMEの新しい章を追加|1コミット|docs(readme): 仮想環境セットアップ手順を追加|
|複数の箇所にまたがる小さな修正（誤字・表現統一）|まとめて1コミット|docs: 誤字修正と表記ゆれを統一|
|複数ファイルを大きく修正（API仕様書 + CONTRIBUTINGなど）|ファイル単位 or 目的単位で分ける|docs(api): PubChem API使用方法を追加 <br> docs(contributing): コミットルールを化合物プロジェクト用に更新|
|-|-|-|

### 6.2.2 粒度の判断基準
|判断軸|説明|
|-|-|
|作業の内容が異なるか|誤字修正、章追加は別作業なので分ける|
|ファイルが異なるか|別ファイルは別commitにする|
|後で戻す可能性はあるか|目的別に分けて、戻す可能性のある部分は細分化してcommitしておく|
|レビューしやすいか|他人がパッと見てわかりやすい区別にする|

ドキュメントは「意味のある変更単位」でコミットする

# 7. コーディング規約・スタイル
- コーディングスタイルは [PEP8](https://pep8-ja.readthedocs.io/ja/latest/) に準拠してください
- Black で自動整形を推奨します
- 変数名や関数名は意味のある名前をつけてください

# 8. テストの実行方法
変更を加えた場合は、以下のテストを実行してください：

```bash
# 仮想環境をアクティベート
source eye_drop_env/bin/activate

# 依存関係をインストール
pip install -r requirements.txt

# サンプルデータでテスト実行
python scripts/fetch_compounds_modular.py --input data/input/compounds.json

# テストフォルダ内のテスト実行（今後実装予定）
# python -m pytest tests/
```

# 9. ライセンスと著作権
- 自社・プロジェクトのルールがある場合。